# λΌμ΄μ„ μ¤ ν‚¤ μƒμ„± λ° κ²€μ¦ μ„λΉ„μ¤

μ΄ ν”„λ΅μ νΈλ” μ†ν”„νΈμ›¨μ–΄ λΌμ΄μ„ μ¤ ν‚¤λ¥Ό κ°„λ‹¨ν•κ³  μ•μ „ν•κ² λ°κΈ‰ν•κ³  κ²€μ¦ν•λ” λ°©λ²•μ„ μ κ³µν•λ” Spring Boot μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤. λ””μ§€ν„Έ μ„λ…(SHA256withRSA)μ΄ μ μ©λ λΉ„λ€μΉ­ ν‚¤ μ•”νΈν™”(RSA)λ¥Ό μ‚¬μ©ν•μ—¬ λΌμ΄μ„ μ¤ ν‚¤μ λ¬΄κ²°μ„±κ³Ό μ‹ λΆ°μ„±μ„ λ³΄μ¥ν•©λ‹λ‹¤.

μƒμ„±λ λΌμ΄μ„ μ¤ ν‚¤λ” JWTμ™€ μ μ‚¬ν•κ² μ μΌλ΅ κµ¬λ¶„λ μ„Έ λ¶€λ¶„μ ν•μ‹(`header.body.signature`)μ„ κ°€μ§‘λ‹λ‹¤.

## β¨ μ£Όμ” κΈ°λ¥

-   **λΌμ΄μ„ μ¤ ν‚¤ λ°κΈ‰**: κ³ κ° λ° μ†”λ£¨μ… μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ κ³ μ ν• λΌμ΄μ„ μ¤ ν‚¤λ¥Ό μƒμ„±ν•©λ‹λ‹¤.
-   **λΉ„λ€μΉ­ μ•”νΈν™”**: μ•μ „ν• ν‚¤ μƒμ„±μ„ μ„ν•΄ κ³µκ°ν‚¤/κ°μΈν‚¤ μ(RSA 2048λΉ„νΈ)μ„ μ‚¬μ©ν•©λ‹λ‹¤.
-   **λ””μ§€ν„Έ μ„λ…**: SHA256withRSAλ¥Ό μ‚¬μ©ν•μ—¬ λΌμ΄μ„ μ¤ ν‚¤κ°€ λ³€μ΅°λμ§€ μ•μ•μμ„ λ³΄μ¥ν•©λ‹λ‹¤.
-   **λΌμ΄μ„ μ¤ ν‚¤ λ””μ½”λ”© λ° κ²€μ¦**: λΌμ΄μ„ μ¤ ν‚¤λ¥Ό λ””μ½”λ”©ν•κ³  κ²€μ¦ν•μ—¬ μ›λ³Έ λ°μ΄ν„°λ¥Ό κ²€μƒ‰ν•κ³  μ ν¨μ„±μ„ ν™•μΈν•©λ‹λ‹¤.
-   **RESTful API**: λΌμ΄μ„ μ¤ ν‚¤ λ°κΈ‰ λ° λ””μ½”λ”©μ„ μ„ν• κ°„λ‹¨ν• REST μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•©λ‹λ‹¤.

---

## π—οΈ ν”„λ΅μ νΈ κµ¬μ΅°

μ΄ ν”„λ΅μ νΈλ” ν‘μ¤€μ μΈ κ³„μΈµν• μ•„ν‚¤ν…μ²λ¥Ό λ”°λ¦…λ‹λ‹¤:

-   `Controller`: λ“¤μ–΄μ¤λ” HTTP μ”μ²­κ³Ό μ‘λ‹µμ„ μ²λ¦¬ν•©λ‹λ‹¤.
-   `Service`: λΌμ΄μ„ μ¤ ν‚¤ μƒμ„± λ° κ²€μ¦μ„ μ„ν• ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§μ„ ν¬ν•¨ν•©λ‹λ‹¤.
-   `DTO` (Data Transfer Object): μ”μ²­ λ° μ‘λ‹µμ„ μ„ν• λ°μ΄ν„° κµ¬μ΅°λ¥Ό μ •μν•©λ‹λ‹¤.
-   `Entity` & `Repository`: Spring Data JPAλ¥Ό μ‚¬μ©ν•μ—¬ λΌμ΄μ„ μ¤ λ°μ΄ν„°μ μμ†μ„±μ„ κ΄€λ¦¬ν•©λ‹λ‹¤.

---

## π› οΈ μ‘λ™ λ°©μ‹

### λΌμ΄μ„ μ¤ μƒμ„±

1.  **μ”μ²­**: ν΄λΌμ΄μ–ΈνΈλ” κ³ κ° μ •λ³΄(`customerid`, `uuid`), λΌμ΄μ„ μ¤ μ„Έλ¶€ μ •λ³΄(`solution`, `expiration`), λΌμ΄μ„ μ¤ λ²„μ „(`license_v`)μ΄ ν¬ν•¨λ JSON λ³Έλ¬ΈμΌλ΅ `/license/issue`μ— `POST` μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.
2.  **ν‚¤ μ μƒμ„±**: κ° λΌμ΄μ„ μ¤μ— λ€ν•΄ μƒλ΅μ΄ RSA 2048λΉ„νΈ κ³µκ°ν‚¤/κ°μΈν‚¤ μμ΄ μƒμ„±λ©λ‹λ‹¤.
3.  **λΌμ΄μ„ μ¤ κµ¬μ„±**:
    * **ν—¤λ”(Header)**: λΌμ΄μ„ μ¤ λ²„μ „(`license_v`)μ„ ν¬ν•¨ν•©λ‹λ‹¤.
    * **λ³Έλ¬Έ(Body)**: λ§λ£μΌ, UUID, κ³ κ° ID, μ†”λ£¨μ… μ΄λ¦„ λ° μƒλ΅ μƒμ„±λ **κ³µκ°ν‚¤**λ¥Ό ν¬ν•¨ν•©λ‹λ‹¤.
4.  **μΈμ½”λ”©**: ν—¤λ”μ™€ λ³Έλ¬Έ λ¨λ‘ Base64Urlλ΅ μΈμ½”λ”©λ©λ‹λ‹¤.
5.  **μ„λ…**: **κ°μΈν‚¤**λ¥Ό μ‚¬μ©ν•μ—¬ `header.body` λ¬Έμμ—΄μ— μ„λ…ν•¨μΌλ΅μ¨ λ””μ§€ν„Έ μ„λ…μ΄ μƒμ„±λ©λ‹λ‹¤.
6.  **μµμΆ… ν‚¤**: μµμΆ… λΌμ΄μ„ μ¤ ν‚¤λ” μΈμ½”λ”©λ ν—¤λ”, μΈμ½”λ”©λ λ³Έλ¬Έ, μΈμ½”λ”©λ μ„λ…μ„ μ μΌλ΅ κ²°ν•©ν• κ²ƒμ…λ‹λ‹¤.
7.  **μμ†μ„±**: λΌμ΄μ„ μ¤ μ •λ³΄λ” λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λ©λ‹λ‹¤.
8.  **μ‘λ‹µ**: μƒμ„±λ λΌμ΄μ„ μ¤ ν‚¤κ°€ ν΄λΌμ΄μ–ΈνΈμ—κ² λ°ν™λ©λ‹λ‹¤. κ°μΈν‚¤λ” κΈ°λ³Έμ μΌλ΅ μ €μ¥λμ§€ μ•μ§€λ§ ν•„μ”ν• κ²½μ° μ„λΉ„μ¤ κ³„μΈµμ—μ„ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.

### λΌμ΄μ„ μ¤ κ²€μ¦

1.  **μ”μ²­**: ν΄λΌμ΄μ–ΈνΈλ” `licenseKey`λ¥Ό μ”μ²­ νλΌλ―Έν„°λ΅ ν•μ—¬ `/license/decode`μ— `GET` μ”μ²­μ„ λ³΄λƒ…λ‹λ‹¤.
2.  **ν‚¤ λ¶„λ¦¬**: ν‚¤λ” ν—¤λ”, λ³Έλ¬Έ, μ„λ…μ μ„Έ λ¶€λ¶„μΌλ΅ λ¶„λ¦¬λ©λ‹λ‹¤.
3.  **λ””μ½”λ”©**: ν—¤λ”μ™€ λ³Έλ¬Έμ€ Base64Urlμ—μ„ λ””μ½”λ”©λμ–΄ JSON ν‘ν„μΌλ΅ λ³€ν™λ©λ‹λ‹¤.
4.  **κ³µκ°ν‚¤ μ¶”μ¶**: λ””μ½”λ”©λ λ³Έλ¬Έμ—μ„ **κ³µκ°ν‚¤**κ°€ μ¶”μ¶λ©λ‹λ‹¤.
5.  **κ²€μ¦**: μ¶”μ¶λ κ³µκ°ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ›λ³Έ `header.body` λ‚΄μ©μ— λ€ν•΄ μ„λ…μ„ κ²€μ¦ν•©λ‹λ‹¤.
6.  **μ‘λ‹µ**:
    * μ„λ…μ΄ **μ ν¨**ν•λ©΄ λ””μ½”λ”©λ λ³Έλ¬Έ λ‚΄μ©μ΄ `200 OK` μƒνƒμ™€ ν•¨κ» λ°ν™λ©λ‹λ‹¤.
    * μ„λ…μ΄ **μ ν¨ν•μ§€ μ•μΌλ©΄** ν‚¤κ°€ λ³€μ΅°λμ—κ±°λ‚ μ ν¨ν•μ§€ μ•μμ„ λ‚νƒ€λ‚΄λ” `SecurityException`μ΄ λ°μƒν•©λ‹λ‹¤.

---

## π€ API μ—”λ“ν¬μΈνΈ

### λΌμ΄μ„ μ¤ λ°κΈ‰

μƒλ΅μ΄ λΌμ΄μ„ μ¤ ν‚¤λ¥Ό μƒμ„±ν•κ³  λ°ν™ν•©λ‹λ‹¤.

-   **URL**: `/license/issue`
-   **λ©”μ„λ“**: `POST`
-   **μ”μ²­ λ³Έλ¬Έ**:

~~~json
{
  "license_v": "1.0",
  "expiration": "2025-12-31",
  "uuid": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
  "customerid": "customer-123",
  "solution": "AwesomeApp",
  "publicKey": null
}
~~~

-   **μ„±κ³µ μ‘λ‹µ (200 OK)**:
    -   **Content-Type**: `text/plain`
    -   **λ³Έλ¬Έ**: λΌμ΄μ„ μ¤ ν‚¤λ¥Ό λ‚νƒ€λ‚΄λ” λ¬Έμμ—΄ (μ: `eyJsaWNlbnNlX3YiOiIxLjAifQ.eyJleHBpcmF0aW9uIjoiMjAyNS0xMi0zMSIsInV1aWQiOiJhMWIyYzNkNC1lNWY2LTc4OTAtMTIzNC01Njc4OTBhYmNkZWYiLCJjdXN0b21lcmlkIjoiY3VzdG9tZXItMTIzIiwic29sdXRpb24iOiJBd2Vzb21lQXBwIiwicHVibGljS2V5IjoibGlrZUIifQ.signature`)

---

### λΌμ΄μ„ μ¤ λ””μ½”λ”© λ° κ²€μ¦

μ κ³µλ λΌμ΄μ„ μ¤ ν‚¤λ¥Ό λ””μ½”λ”©ν•κ³  μ„λ…μ„ κ²€μ¦ν•©λ‹λ‹¤.

-   **URL**: `/license/decode`
-   **λ©”μ„λ“**: `GET`
-   **μΏΌλ¦¬ νλΌλ―Έν„°**: `licenseKey` (string)
-   **μ”μ²­ μμ‹**: `GET /license/decode?licenseKey=eyJsaWNlbnNlX3YiOiIxLjAifQ.eyJleHBpcmF0aW9uIjoiMjAyNS0xMi0zMSIsInV1aWQiOiJhMWIyYzNkNC1lNWY2LTc4OTAtMTIzNC01Njc4OTBhYmNkZWYiLCJjdXN0b21lcmlkIjoiY3VzdG9tZXItMTIzIiwic29sdXRpb24iOiJBd2Vzb21lQXBwIiwicHVibGljS2V5IjoibGlrZUIifQ.signature`

-   **μ„±κ³µ μ‘λ‹µ (200 OK)**:
    -   **Content-Type**: `application/json`
    -   **λ³Έλ¬Έ**:

~~~json
{
  "expiration": "2025-12-31",
  "uuid": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
  "customerid": "customer-123",
  "solution": "AwesomeApp",
  "publicKey": "MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA..."
}
~~~

-   **μ¤λ¥ μ‘λ‹µ**: μ„λ…μ΄ μ ν¨ν•μ§€ μ•μΌλ©΄ μ„λ²„ μ¤λ¥κ°€ λ°μƒν•©λ‹λ‹¤.

μ• ν”λ¦¬μΌ€μ΄μ…μ€ κµ¬μ„±λ ν¬νΈ(8081)μ—μ„ μ‹μ‘λ©λ‹λ‹¤.